---
sidebar: sidebar 
permalink: prev-ontap-backup-onprem-aws.html 
keywords: backing up, back up, backup, backup application data, Amazon Web services, AWS, NetApp Backup and Recovery, Oracle database, Microsoft SQL Server database, SAP HANA database 
summary: NetApp NetApp Backup and Recovery 사용하여 VMware 워크로드를 보호하세요. 
---
= NetApp Backup and Recovery 사용하여 온프레미스 ONTAP 데이터를 Amazon S3에 백업하세요.
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
NetApp Backup and Recovery 에서 몇 가지 단계를 완료하여 온프레미스 ONTAP 시스템의 볼륨 데이터를 보조 스토리지 시스템과 Amazon S3 클라우드 스토리지로 백업하세요.


NOTE: "온프레미스 ONTAP 시스템"에는 FAS, AFF 및 ONTAP Select 시스템이 포함됩니다.

[]
====
*참고* NetApp Backup and Recovery 워크로드로 전환하려면 다음을 참조하세요.link:br-start-switch-ui.html["다양한 NetApp Backup and Recovery 워크로드로 전환"] .

====


== 연결 방법을 식별하세요

온프레미스 ONTAP 시스템에서 AWS S3로 백업을 구성할 때 두 가지 연결 방법 중 어떤 것을 사용할지 선택하세요.

* *공개 연결* - 공개 S3 엔드포인트를 사용하여 ONTAP 시스템을 AWS S3에 직접 연결합니다.
* *개인 연결* - VPN 또는 AWS Direct Connect를 사용하고 개인 IP 주소를 사용하는 VPC 엔드포인트 인터페이스를 통해 트래픽을 라우팅합니다.


선택적으로, 공용 또는 개인 연결을 사용하여 복제된 볼륨의 보조 ONTAP 시스템에 연결할 수도 있습니다.

다음 다이어그램은 *공개 연결* 방법과 구성 요소 간에 준비해야 하는 연결을 보여줍니다. 사내에 설치한 콘솔 에이전트나 AWS VPC에 배포한 콘솔 에이전트를 사용할 수 있습니다.

image:diagram_cloud_backup_onprem_aws_public.png["NetApp Backup and Recovery 클러스터의 볼륨과 백업 파일이 있는 AWS S3 스토리지와 공용 연결을 통해 통신하는 방식을 보여주는 다이어그램입니다."]

다음 다이어그램은 *개인 연결* 방법과 구성 요소 간에 준비해야 하는 연결을 보여줍니다. 사내에 설치한 콘솔 에이전트나 AWS VPC에 배포한 콘솔 에이전트를 사용할 수 있습니다.

image:diagram_cloud_backup_onprem_aws_private.png["NetApp Backup and Recovery 백업 파일이 있는 클러스터의 볼륨과 AWS S3 스토리지와 개인 연결을 통해 통신하는 방식을 보여주는 다이어그램입니다."]



== 콘솔 에이전트를 준비하세요

콘솔 에이전트는 NetApp Console 기능을 위한 주요 소프트웨어입니다.  ONTAP 데이터를 백업하고 복원하려면 콘솔 에이전트가 필요합니다.



=== 콘솔 에이전트 만들기 또는 전환

AWS VPC나 사내에 콘솔 에이전트가 이미 배포되어 있다면 준비가 완료된 것입니다.

그렇지 않은 경우 해당 위치 중 하나에 콘솔 에이전트를 만들어 ONTAP 데이터를 AWS S3 스토리지에 백업해야 합니다.  다른 클라우드 공급자에 배포된 콘솔 에이전트를 사용할 수 없습니다.

* https://docs.netapp.com/us-en/console-setup-admin/concept-connectors.html["콘솔 에이전트에 대해 알아보세요"^]
* https://docs.netapp.com/us-en/console-setup-admin/task-quick-start-connector-aws.html["AWS에 콘솔 에이전트 설치"^]
* https://docs.netapp.com/us-en/console-setup-admin/task-quick-start-connector-on-prem.html["귀하의 구내에 콘솔 에이전트를 설치하세요"^]
* https://docs.netapp.com/us-en/console-setup-admin/task-install-restricted-mode.html["AWS GovCloud 지역에 콘솔 에이전트 설치"^]
+
NetApp Backup and Recovery 콘솔 에이전트가 클라우드에 배포된 경우에만 GovCloud 지역에서 지원되며, 사내에 설치된 경우에는 지원되지 않습니다.  또한 AWS Marketplace에서 콘솔 에이전트를 배포해야 합니다.  NetApp Console SaaS 웹사이트에서는 정부 지역에 콘솔 에이전트를 배포할 수 없습니다.





=== 콘솔 에이전트 네트워킹 요구 사항 준비

다음 네트워킹 요구 사항이 충족되는지 확인하세요.

* 콘솔 에이전트가 설치된 네트워크에서 다음 연결이 허용되는지 확인하세요.
+
** NetApp Backup and Recovery 와 S3 개체 스토리지에 대한 포트 443을 통한 HTTPS 연결(https://docs.netapp.com/us-en/console-setup-admin/task-set-up-networking-aws.html#endpoints-contacted-for-day-to-day-operations["엔드포인트 목록을 확인하세요"^] )
** ONTAP 클러스터 관리 LIF에 대한 포트 443을 통한 HTTPS 연결
** AWS 및 AWS GovCloud 배포에는 추가적인 인바운드 및 아웃바운드 보안 그룹 규칙이 필요합니다. 보다 https://docs.netapp.com/us-en/console-setup-admin/reference-ports-aws.html["AWS의 콘솔 에이전트에 대한 규칙"^] 자세한 내용은.


* ONTAP 클러스터에서 VPC로 Direct Connect 또는 VPN 연결이 있고 콘솔 에이전트와 S3 간의 통신을 AWS 내부 네트워크(비공개 연결)에 유지하려는 경우 S3에 대한 VPC 엔드포인트 인터페이스를 활성화해야 합니다. <<VPC 엔드포인트 인터페이스를 사용하여 개인 연결을 위한 시스템 구성>>.




== 라이센스 요구 사항 확인

AWS와 NetApp Console 모두에 대한 라이선스 요구 사항을 확인해야 합니다.

* 클러스터에 대한 NetApp Backup and Recovery 활성화하려면 먼저 AWS에서 제공하는 PAYGO(Pay-as-you-go) NetApp Console 마켓플레이스에 가입하거나 NetApp 에서 NetApp Backup and Recovery BYOL 라이선스를 구매하여 활성화해야 합니다.  이러한 라이선스는 귀하의 계정에 적용되며 여러 시스템에서 사용할 수 있습니다.
+
** NetApp Backup and Recovery PAYGO 라이선싱의 경우 구독이 필요합니다. https://aws.amazon.com/marketplace/pp/prodview-oorxakq6lq7m4?sr=0-8&ref_=beagle&applicationId=AWSMPContessa["AWS Marketplace에서 제공하는 NetApp Console"^] .  NetApp Backup and Recovery 대한 청구는 이 구독을 통해 이루어집니다.
** NetApp Backup and Recovery BYOL 라이선스의 경우, 라이선스 기간과 용량 동안 서비스를 사용할 수 있도록 하는 NetApp 의 일련 번호가 필요합니다.


* 백업이 저장될 개체 스토리지 공간에 대한 AWS 구독이 필요합니다.


*지원 지역*

AWS GovCloud 지역을 포함한 모든 지역의 온프레미스 시스템에서 Amazon S3로 백업을 생성할 수 있습니다.  서비스를 설정할 때 백업을 저장할 지역을 지정합니다.



== ONTAP 클러스터 준비

소스 온프레미스 ONTAP 시스템과 보조 온프레미스 ONTAP 또는 Cloud Volumes ONTAP 시스템을 준비해야 합니다.

ONTAP 클러스터를 준비하는 단계는 다음과 같습니다.

* NetApp Console 에서 ONTAP 시스템을 찾아보세요
* ONTAP 시스템 요구 사항 확인
* 개체 스토리지에 데이터를 백업하기 위한 ONTAP 네트워킹 요구 사항 확인
* 볼륨 복제를 위한 ONTAP 네트워킹 요구 사항 확인




=== NetApp Console 에서 ONTAP 시스템을 찾아보세요

소스 온프레미스 ONTAP 시스템과 보조 온프레미스 ONTAP 또는 Cloud Volumes ONTAP 시스템 모두 NetApp Console *시스템* 페이지에서 사용할 수 있어야 합니다.

클러스터를 추가하려면 클러스터 관리 IP 주소와 관리자 사용자 계정의 비밀번호를 알아야 합니다. https://docs.netapp.com/us-en/storage-management-ontap-onprem/task-discovering-ontap.html["클러스터를 검색하는 방법을 알아보세요"^].



=== ONTAP 시스템 요구 사항 확인

다음 ONTAP 요구 사항이 충족되는지 확인하세요.

* 최소 ONTAP 9.8; ONTAP 9.8P13 이상을 권장합니다.
* SnapMirror 라이선스(프리미엄 번들 또는 데이터 보호 번들의 일부로 포함됨).
+
*참고:* NetApp Backup and Recovery 사용하는 경우 "하이브리드 클라우드 번들"은 필요하지 않습니다.

+
방법을 배우십시오 https://docs.netapp.com/us-en/ontap/system-admin/manage-licenses-concept.html["클러스터 라이선스 관리"^] .

* 시간과 시간대가 올바르게 설정되었습니다.  방법을 배우십시오 https://docs.netapp.com/us-en/ontap/system-admin/manage-cluster-time-concept.html["클러스터 시간 구성"^] .
* 데이터를 복제하려는 경우 데이터를 복제하기 전에 소스 및 대상 시스템에서 호환되는 ONTAP 버전이 실행되고 있는지 확인해야 합니다.
+
https://docs.netapp.com/us-en/ontap/data-protection/compatible-ontap-versions-snapmirror-concept.html["SnapMirror 관계에 대한 호환 ONTAP 버전 보기"^].





=== 개체 스토리지에 데이터를 백업하기 위한 ONTAP 네트워킹 요구 사항 확인

개체 스토리지에 연결하는 시스템에서 다음 요구 사항을 구성해야 합니다.

* 팬아웃 백업 아키텍처의 경우 _기본_ 시스템에서 다음 설정을 구성합니다.
* 계단식 백업 아키텍처의 경우 _보조_ 시스템에서 다음 설정을 구성합니다.


다음과 같은 ONTAP 클러스터 네트워킹 요구 사항이 필요합니다.

* 클러스터에는 콘솔 에이전트에서 클러스터 관리 LIF로의 인바운드 HTTPS 연결이 필요합니다.
* 백업하려는 볼륨을 호스팅하는 각 ONTAP 노드에는 클러스터 간 LIF가 필요합니다. 이러한 클러스터 간 LIF는 개체 저장소에 액세스할 수 있어야 합니다.
+
클러스터는 백업 및 복원 작업을 위해 클러스터 간 LIF에서 Amazon S3 스토리지로 포트 443을 통해 아웃바운드 HTTPS 연결을 시작합니다. ONTAP 개체 스토리지에서 데이터를 읽고 씁니다. 개체 스토리지는 결코 시작하지 않고 단지 응답만 합니다.

* 클러스터 간 LIF는 ONTAP 개체 스토리지에 연결하는 데 사용해야 하는 _IPspace_와 연결되어야 합니다. https://docs.netapp.com/us-en/ontap/networking/standard_properties_of_ipspaces.html["IPspaces에 대해 자세히 알아보세요"^] .
+
NetApp Backup and Recovery 설정하면 사용할 IP 공간을 입력하라는 메시지가 표시됩니다. 이러한 LIF가 연결된 IP 공간을 선택해야 합니다. 이는 "기본" IP 공간일 수도 있고 사용자가 만든 사용자 지정 IP 공간일 수도 있습니다.

+
"기본"이 아닌 다른 IP 공간을 사용하는 경우 개체 스토리지에 액세스하려면 정적 경로를 만들어야 할 수도 있습니다.

+
IPspace 내의 모든 클러스터 간 LIF는 개체 저장소에 액세스할 수 있어야 합니다. 현재 IP 공간에 대해 이를 구성할 수 없는 경우 모든 클러스터 간 LIF가 개체 저장소에 액세스할 수 있는 전용 IP 공간을 만들어야 합니다.

* 볼륨이 위치한 스토리지 VM에 대해 DNS 서버가 구성되어야 합니다.  방법을 확인하세요 https://docs.netapp.com/us-en/ontap/networking/configure_dns_services_auto.html["SVM에 대한 DNS 서비스 구성"^] .
* 필요한 경우 방화벽 규칙을 업데이트하여 ONTAP 에서 개체 스토리지로의 NetApp Backup and Recovery 연결이 포트 443을 통해 허용되고 스토리지 VM에서 DNS 서버로의 이름 확인 트래픽이 포트 53(TCP/UDP)을 통해 허용되도록 합니다.
* AWS에서 S3 연결을 위해 Private VPC Interface Endpoint를 사용하는 경우 HTTPS/443을 사용하려면 S3 엔드포인트 인증서를 ONTAP 클러스터에 로드해야 합니다. <<VPC 엔드포인트 인터페이스를 사용하여 개인 연결을 위한 시스템 구성>>.  *[ ONTAP 클러스터에 S3 버킷에 액세스할 수 있는 권한이 있는지 확인하세요.




=== 볼륨 복제를 위한 ONTAP 네트워킹 요구 사항 확인

NetApp Backup and Recovery 사용하여 보조 ONTAP 시스템에 복제된 볼륨을 생성하려는 경우 소스 및 대상 시스템이 다음 네트워킹 요구 사항을 충족하는지 확인하세요.



==== 온프레미스 ONTAP 네트워킹 요구 사항

* 클러스터가 사내에 있는 경우 회사 네트워크에서 클라우드 공급자의 가상 네트워크로 연결되어야 합니다. 이는 일반적으로 VPN 연결입니다.
* ONTAP 클러스터는 추가적인 서브넷, 포트, 방화벽 및 클러스터 요구 사항을 충족해야 합니다.
+
Cloud Volumes ONTAP 또는 온프레미스 시스템에 복제할 수 있으므로 온프레미스 ONTAP 시스템에 대한 피어링 요구 사항을 검토하세요. https://docs.netapp.com/us-en/ontap-sm-classic/peering/reference_prerequisites_for_cluster_peering.html["ONTAP 설명서에서 클러스터 피어링에 대한 필수 구성 요소 보기"^] .





==== Cloud Volumes ONTAP 네트워킹 요구 사항

* 인스턴스의 보안 그룹에는 필수 인바운드 및 아웃바운드 규칙이 포함되어야 합니다. 구체적으로는 ICMP 및 포트 11104와 11105에 대한 규칙이 포함됩니다. 이러한 규칙은 미리 정의된 보안 그룹에 포함됩니다.




== Amazon S3를 백업 대상으로 준비하세요

Amazon S3를 백업 대상으로 준비하려면 다음 단계를 따르세요.

* S3 권한을 설정합니다.
* (선택 사항) 나만의 S3 버킷을 만듭니다.  (원하시면 서비스에서 버킷을 만들어드립니다.)
* (선택 사항) 데이터 암호화를 위해 고객 관리 AWS 키를 설정합니다.
* (선택 사항) VPC 엔드포인트 인터페이스를 사용하여 개인 연결을 위해 시스템을 구성합니다.




=== S3 권한 설정

두 가지 권한 세트를 구성해야 합니다.

* 콘솔 에이전트가 S3 버킷을 생성하고 관리할 수 있는 권한입니다.
* 온프레미스 ONTAP 클러스터가 S3 버킷에서 데이터를 읽고 쓸 수 있는 권한입니다.


.단계
. 콘솔 에이전트에 필요한 권한이 있는지 확인하세요.  자세한 내용은 다음을 참조하세요. https://docs.netapp.com/us-en/console-setup-admin/reference-permissions-aws.html["NetApp Console 정책 권한"^] .
+

NOTE: AWS 중국 리전에서 백업을 생성할 때 IAM 정책의 모든 _Resource_ 섹션 아래에 있는 AWS 리소스 이름 "arn"을 "aws"에서 "aws-cn"으로 변경해야 합니다. 예를 들어, `arn:aws-cn:s3:::netapp-backup-*` .

. 서비스를 활성화하면 백업 마법사가 액세스 키와 비밀 키를 입력하라는 메시지를 표시합니다.  이러한 자격 증명은 ONTAP 클러스터에 전달되어 ONTAP S3 버킷에 데이터를 백업하고 복원할 수 있도록 합니다.  이를 위해서는 다음 권한이 있는 IAM 사용자를 만들어야 합니다.
+
를 참조하세요 https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user.html["AWS 설명서: IAM 사용자에게 권한을 위임하는 역할 생성"^] .

+
[%collapsible]
====
[source, json]
----
{
    "Version": "2012-10-17",
     "Statement": [
        {
           "Action": [
                "s3:GetObject",
                "s3:PutObject",
                "s3:DeleteObject",
                "s3:ListBucket",
                "s3:ListAllMyBuckets",
                "s3:GetBucketLocation",
                "s3:PutEncryptionConfiguration"
            ],
            "Resource": "arn:aws:s3:::netapp-backup-*",
            "Effect": "Allow",
            "Sid": "backupPolicy"
        },
        {
            "Action": [
                "s3:ListBucket",
                "s3:GetBucketLocation"
            ],
            "Resource": "arn:aws:s3:::netapp-backup*",
            "Effect": "Allow"
        },
        {
            "Action": [
                "s3:GetObject",
                "s3:PutObject",
                "s3:DeleteObject",
                "s3:ListAllMyBuckets",
                "s3:PutObjectTagging",
                "s3:GetObjectTagging",
                "s3:RestoreObject",
                "s3:GetBucketObjectLockConfiguration",
                "s3:GetObjectRetention",
                "s3:PutBucketObjectLockConfiguration",
                "s3:PutObjectRetention"
            ],
            "Resource": "arn:aws:s3:::netapp-backup*/*",
            "Effect": "Allow"
        }
    ]
}
----
====




=== 나만의 버킷을 만들어보세요

기본적으로 서비스는 사용자를 위해 버킷을 생성합니다.  또는, 사용자 고유의 버킷을 사용하려면 백업 활성화 마법사를 시작하기 전에 버킷을 만든 다음 마법사에서 해당 버킷을 선택하면 됩니다.

link:prev-ontap-protect-journey.html["나만의 버킷을 만드는 방법에 대해 자세히 알아보세요"^].

자체 버킷을 생성하는 경우 버킷 이름으로 "netapp-backup"을 사용해야 합니다.  사용자 정의 이름을 사용해야 하는 경우 다음을 편집하세요. `ontapcloud-instance-policy-netapp-backup` 기존 CVO에 대한 IAMRole을 설정하고 다음 목록을 S3 권한에 추가합니다.  포함해야 합니다 `"Resource": "arn:aws:s3:::*"` 그리고 버킷과 연관되어야 하는 모든 필수 권한을 할당합니다.

[%collapsible]
====
"동작": [ "S3:ListBucket" "S3:GetBucketLocation" ] "리소스": "arn:aws:s3:::*", "효과": "허용" }, { "동작": [ "S3:GetObject", "S3:PutObject", "S3:DeleteObject", "S3:ListAllMyBuckets", "S3:PutObjectTagging", "S3:GetObjectTagging", "S3:RestoreObject", "S3:GetBucketObjectLockConfiguration", "S3:GetObjectRetention", "S3:PutBucketObjectLockConfiguration", "S3:PutObjectRetention" ] "리소스": "arn:aws:s3:::*",

====


=== 데이터 암호화를 위한 고객 관리 AWS 키 설정

온프레미스 클러스터와 S3 버킷 간에 전달되는 데이터를 암호화하기 위해 기본 Amazon S3 암호화 키를 사용하려는 경우, 기본 설치에서 해당 유형의 암호화가 사용되므로 모든 준비가 완료된 것입니다.

대신 기본 키를 사용하는 대신 고객이 관리하는 키를 사용하여 데이터를 암호화하려는 경우 NetApp Backup and Recovery 마법사를 시작하기 전에 암호화 관리 키를 미리 설정해야 합니다.

https://docs.netapp.com/us-en/storage-management-cloud-volumes-ontap/task-setting-up-kms.html["Cloud Volumes ONTAP 에서 자체 Amazon 암호화 키를 사용하는 방법을 참조하세요."^].

https://docs.netapp.com/us-en/console-setup-admin/task-install-connector-aws-bluexp.html#configure-encryption-settings["NetApp Backup and Recovery 에서 자체 Amazon 암호화 키를 사용하는 방법을 참조하세요."^].



=== VPC 엔드포인트 인터페이스를 사용하여 개인 연결을 위한 시스템 구성

표준 공용 인터넷 연결을 사용하려는 경우 모든 권한은 콘솔 에이전트에 의해 설정되므로 그 외에는 아무것도 할 필요가 없습니다.

온프레미스 데이터 센터에서 VPC로 인터넷을 통해 보다 안전한 연결을 원하는 경우 백업 활성화 마법사에서 AWS PrivateLink 연결을 선택하는 옵션이 있습니다. 개인 IP 주소를 사용하는 VPC 엔드포인트 인터페이스를 통해 온프레미스 시스템에 연결하기 위해 VPN이나 AWS Direct Connect를 사용하려는 경우 필요합니다.

.단계
. Amazon VPC 콘솔이나 명령줄을 사용하여 인터페이스 엔드포인트 구성을 만듭니다. https://docs.aws.amazon.com/AmazonS3/latest/userguide/privatelink-interface-endpoints.html["Amazon S3에 AWS PrivateLink를 사용하는 방법에 대한 자세한 내용을 참조하세요."^] .
. 콘솔 에이전트와 연결된 보안 그룹 구성을 수정합니다. 정책을 "전체 액세스"에서 "사용자 지정"으로 변경해야 합니다.<<S3 권한 설정,백업 정책에서 S3 권한을 추가합니다.>> 앞서 보여준 것처럼.
+
개인 엔드포인트와 통신하기 위해 포트 80(HTTP)을 사용한다면 준비가 완료된 것입니다. 이제 클러스터에서 NetApp Backup and Recovery 활성화할 수 있습니다.

+
개인 엔드포인트와 통신하기 위해 포트 443(HTTPS)을 사용하는 경우 다음 4단계에 표시된 대로 VPC S3 엔드포인트에서 인증서를 복사하여 ONTAP 클러스터에 추가해야 합니다.

. AWS 콘솔에서 엔드포인트의 DNS 이름을 얻습니다.
. VPC S3 엔드포인트에서 인증서를 가져옵니다. 당신은 이것을 이렇게 합니다 https://docs.netapp.com/us-en/console-setup-admin/task-maintain-connectors.html#connect-to-the-linux-vm["콘솔 에이전트를 호스팅하는 VM에 로그인"^] 다음 명령을 실행합니다. 엔드포인트의 DNS 이름을 입력할 때 "*"를 "bucket"으로 바꿔서 처음에 추가합니다.
+
[source, text]
----
[ec2-user@ip-10-160-4-68 ~]$ openssl s_client -connect bucket.vpce-0ff5c15df7e00fbab-yxs7lt8v.s3.us-west-2.vpce.amazonaws.com:443 -showcerts
----
. 이 명령의 출력에서 S3 인증서에 대한 데이터를 복사합니다(BEGIN / END CERTIFICATE 태그를 포함하여 그 사이의 모든 데이터).
+
[source, text]
----
Certificate chain
0 s:/CN=s3.us-west-2.amazonaws.com`
   i:/C=US/O=Amazon/OU=Server CA 1B/CN=Amazon
-----BEGIN CERTIFICATE-----
MIIM6zCCC9OgAwIBAgIQA7MGJ4FaDBR8uL0KR3oltTANBgkqhkiG9w0BAQsFADBG
…
…
GqvbOz/oO2NWLLFCqI+xmkLcMiPrZy+/6Af+HH2mLCM4EsI2b+IpBmPkriWnnxo=
-----END CERTIFICATE-----
----
. ONTAP 클러스터 CLI에 로그인하고 다음 명령을 사용하여 복사한 인증서를 적용합니다(사용자의 스토리지 VM 이름으로 대체).
+
[source, text]
----
cluster1::> security certificate install -vserver cluster1 -type server-ca
Please enter Certificate: Press <Enter> when done
----




== ONTAP 볼륨에서 백업 활성화

언제든지 온프레미스 시스템에서 직접 백업을 활성화하세요.

마법사가 다음의 주요 단계를 안내합니다.

* <<백업할 볼륨을 선택하세요>>
* <<백업 전략 정의>>
* <<선택 사항을 검토하세요>>


당신도 할 수 있습니다<<API 명령 표시>> 검토 단계에서 코드를 복사하여 향후 시스템에 대한 백업 활성화를 자동화할 수 있습니다.



=== 마법사 시작

.단계
. 다음 방법 중 하나를 사용하여 백업 및 복구 활성화 마법사에 액세스하세요.
+
** 콘솔의 *시스템* 페이지에서 시스템을 선택하고 오른쪽 패널의 백업 및 복구 옆에 있는 *활성화 > 백업 볼륨*을 선택합니다.
+
백업을 위한 Amazon S3 대상이 콘솔의 시스템 페이지에 시스템으로 존재하는 경우 ONTAP 클러스터를 Amazon S3 개체 스토리지로 끌어다 놓을 수 있습니다.

** 백업 및 복구 표시줄에서 *볼륨*을 선택합니다.  볼륨 탭에서 *작업*을 선택하세요.image:icon-action.png["작업 아이콘"] 아이콘을 클릭하고 단일 볼륨(이미 복제나 개체 스토리지 백업이 활성화되지 않은 볼륨)에 대해 *백업 활성화*를 선택합니다.


+
마법사의 소개 페이지에는 로컬 스냅샷, 복제, 백업을 포함한 보호 옵션이 표시됩니다.  이 단계에서 두 번째 옵션을 선택한 경우, 하나의 볼륨이 선택된 상태로 백업 전략 정의 페이지가 나타납니다.

. 다음 옵션을 계속 진행하세요.
+
** 이미 콘솔 에이전트가 있다면 준비가 완료된 것입니다.  *다음*을 선택하세요.
** 아직 콘솔 에이전트가 없으면 *콘솔 에이전트 추가* 옵션이 나타납니다.  참조하다<<콘솔 에이전트를 준비하세요>> .






=== 백업할 볼륨을 선택하세요

보호할 볼륨을 선택하세요.  보호된 볼륨은 다음 중 하나 이상을 갖춘 볼륨입니다. 스냅샷 정책, 복제 정책, 개체 정책으로의 백업.

FlexVol 또는 FlexGroup 볼륨을 보호하도록 선택할 수 있습니다. 그러나 시스템 백업을 활성화할 때 이러한 볼륨을 혼합하여 선택할 수는 없습니다.  방법을 확인하세요link:prev-ontap-backup-manage.html["시스템의 추가 볼륨에 대한 백업을 활성화합니다."] (FlexVol 또는 FlexGroup) 초기 볼륨에 대한 백업을 구성한 후.

[NOTE]
====
* 한 번에 하나의 FlexGroup 볼륨에서만 백업을 활성화할 수 있습니다.
* 선택한 볼륨에는 동일한 SnapLock 설정이 있어야 합니다.  모든 볼륨에는 SnapLock Enterprise 활성화되어 있어야 하거나 SnapLock 비활성화되어 있어야 합니다.


====
.단계
선택한 볼륨에 이미 스냅샷이나 복제 정책이 적용된 경우 나중에 선택하는 정책이 기존 정책을 덮어씁니다.

. 볼륨 선택 페이지에서 보호하려는 볼륨을 선택합니다.
+
** 선택적으로, 특정 볼륨 유형, 스타일 등을 갖춘 볼륨만 표시하도록 행을 필터링하여 선택을 더 쉽게 할 수 있습니다.
** 첫 번째 볼륨을 선택한 후에는 모든 FlexVol 볼륨을 선택할 수 있습니다(FlexGroup 볼륨은 한 번에 하나씩만 선택할 수 있습니다).  기존의 모든 FlexVol 볼륨을 백업하려면 먼저 볼륨 하나를 선택한 다음 제목 행의 상자를 선택합니다.
** 개별 볼륨을 백업하려면 각 볼륨의 상자를 선택하세요.


. *다음*을 선택하세요.




=== 백업 전략 정의

백업 전략을 정의하려면 다음 옵션을 설정해야 합니다.

* 로컬 스냅샷, 복제 및 개체 스토리지 백업 등 백업 옵션 중 하나 또는 전부를 원하는지 여부
* 아키텍처
* 로컬 스냅샷 정책
* 복제 대상 및 정책
+

NOTE: 선택한 볼륨에 이 단계에서 선택한 정책과 다른 스냅샷 및 복제 정책이 있는 경우 기존 정책이 덮어쓰여집니다.

* 개체 스토리지 정보(공급자, 암호화, 네트워킹, 백업 정책 및 내보내기 옵션)에 대한 백업입니다.


.단계
. 백업 전략 정의 페이지에서 다음 중 하나 또는 모두를 선택하세요.  기본적으로 세 가지 모두 선택되어 있습니다.
+
** *로컬 스냅샷*: 개체 스토리지에 복제나 백업을 수행하는 경우 로컬 스냅샷을 만들어야 합니다.
** *복제*: 다른 ONTAP 스토리지 시스템에 복제된 볼륨을 생성합니다.
** *백업*: 볼륨을 개체 스토리지에 백업합니다.


. *아키텍처*: 복제 및 백업을 선택한 경우 다음 정보 흐름 중 하나를 선택하세요.
+
** *계단식*: 정보는 기본 저장소에서 보조 저장소로, 보조 저장소에서 객체 저장소로 흐릅니다.
** *팬아웃*: 정보는 기본 스토리지에서 보조 스토리지로, 기본 스토리지에서 개체 스토리지로 흐릅니다.
+
이러한 아키텍처에 대한 자세한 내용은 다음을 참조하세요.link:prev-ontap-protect-journey.html["보호 여정을 계획하세요"] .



. *로컬 스냅샷*: 기존 스냅샷 정책을 선택하거나 정책을 만듭니다.
+

TIP: 스냅샷을 활성화하기 전에 사용자 정의 정책을 생성하려면 다음을 참조하세요.link:br-use-policies-create.html["정책 만들기"] .

. 정책을 만들려면 *새 정책 만들기*를 선택하고 다음을 수행하세요.
+
** 정책의 이름을 입력하세요.
** 일반적으로 서로 다른 빈도로 최대 5개의 일정을 선택하세요.
+
*** 개체 백업 정책의 경우 DataLock 및 랜섬웨어 복원력 설정을 지정합니다.  DataLock 및 랜섬웨어 복원력에 대한 자세한 내용은 다음을 참조하세요.link:prev-ontap-policy-object-options.html["개체 백업 정책 설정"] .


** *만들기*를 선택하세요.


. *복제*: 다음 옵션을 설정합니다.
+
** *복제 대상*: 대상 시스템과 SVM을 선택합니다.  선택적으로 복제된 볼륨 이름에 추가될 대상 집계 또는 집계와 접두사 또는 접미사를 선택합니다.
** *복제 정책*: 기존 복제 정책을 선택하거나 정책을 만듭니다.
+

TIP: 복제를 활성화하기 전에 사용자 지정 정책을 생성하려면 다음을 참조하세요.link:br-use-policies-create.html["정책 만들기"] .

+
정책을 만들려면 *새 정책 만들기*를 선택하고 다음을 수행하세요.

+
*** 정책의 이름을 입력하세요.
*** 일반적으로 서로 다른 빈도로 최대 5개의 일정을 선택하세요.
*** *만들기*를 선택하세요.




. *개체로 백업*: *백업*을 선택한 경우 다음 옵션을 설정합니다.
+
** *공급자*: *Amazon Web Services*를 선택하세요.
** *공급자 설정*: 공급자 세부 정보와 백업이 저장될 AWS 지역을 입력합니다.
+
액세스 키와 비밀 키는 ONTAP 클러스터에 S3 버킷에 대한 액세스 권한을 부여하기 위해 생성한 IAM 사용자를 위한 것입니다.

** *버킷*: 기존 S3 버킷을 선택하거나 새 버킷을 만듭니다.  참조하다 https://docs.netapp.com/us-en/storage-management-s3-storage/task-add-s3-bucket.html["S3 버킷 추가"^] .
** *암호화 키*: 새 S3 버킷을 생성한 경우 공급자로부터 받은 암호화 키 정보를 입력하세요.  데이터 암호화를 관리하기 위해 기본 Amazon S3 암호화 키를 사용할지, 아니면 AWS 계정에서 고객이 관리하는 키를 선택할지 선택하세요.


+

NOTE: 기존 버킷을 선택한 경우 암호화 정보가 이미 제공되므로 지금 입력할 필요가 없습니다.

+
** *네트워킹*: IP 공간을 선택하고 개인 엔드포인트를 사용할지 여부를 선택합니다.  개인 엔드포인트는 기본적으로 비활성화되어 있습니다.
+
... 백업하려는 볼륨이 있는 ONTAP 클러스터의 IP 공간입니다. 이 IP공간의 클러스터 간 LIF에는 아웃바운드 인터넷 액세스가 있어야 합니다.
... 선택적으로, 이전에 구성한 AWS PrivateLink를 사용할지 여부를 선택합니다. https://docs.aws.amazon.com/AmazonS3/latest/userguide/privatelink-interface-endpoints.html["Amazon S3에 AWS PrivateLink를 사용하는 방법에 대한 자세한 내용을 확인하세요."^] .


** *백업 정책*: 기존 백업 정책을 선택하거나 정책을 만듭니다.
+

TIP: 백업을 활성화하기 전에 사용자 정의 정책을 생성하려면 다음을 참조하세요.link:br-use-policies-create.html["정책 만들기"] .

+
정책을 만들려면 *새 정책 만들기*를 선택하고 다음을 수행하세요.

+
*** 정책의 이름을 입력하세요.
*** 일반적으로 서로 다른 빈도로 최대 5개의 일정을 선택하세요.
*** *만들기*를 선택하세요.


** *기존 스냅샷 복사본을 백업 복사본으로 개체 스토리지로 내보내기*: 이 시스템에 방금 선택한 백업 일정 레이블(예: 매일, 매주 등)과 일치하는 볼륨의 로컬 스냅샷 복사본이 있는 경우 이 추가 메시지가 표시됩니다.  볼륨에 대한 가장 완벽한 보호를 보장하기 위해 모든 이전 스냅샷을 백업 파일로 개체 스토리지에 복사하려면 이 상자를 선택하세요.


. *다음*을 선택하세요.




=== 선택 사항을 검토하세요

이는 귀하의 선택 사항을 검토하고 필요한 경우 조정할 수 있는 기회입니다.

.단계
. 검토 페이지에서 선택 사항을 검토하세요.
. 선택적으로 *스냅샷 정책 레이블을 복제 및 백업 정책 레이블과 자동으로 동기화* 확인란을 선택합니다.  이렇게 하면 복제 및 백업 정책의 레이블과 일치하는 레이블이 있는 스냅샷이 생성됩니다.
. *백업 활성화*를 선택하세요.


.결과
NetApp Backup and Recovery 볼륨의 초기 백업을 시작합니다.  복제된 볼륨과 백업 파일의 기준 전송에는 기본 스토리지 시스템 데이터의 전체 사본이 포함됩니다.  이후 전송에는 스냅샷 복사본에 포함된 기본 데이터의 차등 복사본이 포함됩니다.

대상 클러스터에 복제된 볼륨이 생성되어 기본 저장소 볼륨과 동기화됩니다.

S3 액세스 키와 비밀 키를 입력한 서비스 계정에 S3 버킷이 생성되고, 백업 파일은 해당 계정에 저장됩니다.  볼륨 백업 대시보드가 표시되어 백업 상태를 모니터링할 수 있습니다.

다음을 사용하여 백업 및 복원 작업의 상태를 모니터링할 수도 있습니다.link:br-use-monitor-tasks.html["작업 모니터링 페이지"^] .



=== API 명령 표시

백업 및 복구 활성화 마법사에서 사용되는 API 명령을 표시하고 선택적으로 복사할 수 있습니다.  향후 시스템에서 백업 활성화를 자동화하려면 이 작업을 수행하는 것이 좋습니다.

.단계
. 백업 및 복구 활성화 마법사에서 *API 요청 보기*를 선택합니다.
. 명령을 클립보드에 복사하려면 *복사* 아이콘을 선택하세요.

