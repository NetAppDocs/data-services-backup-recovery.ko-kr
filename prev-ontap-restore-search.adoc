---
sidebar: sidebar 
permalink: prev-ontap-restore-search.html 
keywords: backing up, back up, backup, backup application data, Amazon Web services, AWS, NetApp Backup and Recovery, Oracle database, Microsoft SQL Server database, SAP HANA database 
summary: 검색 및 복원을 사용하면 ONTAP 백업 파일에서 볼륨, 폴더 또는 파일을 복구할 수 있습니다. 
---
= 검색 및 복원을 사용하여 ONTAP 백업에서 복원
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
검색 및 복원을 사용하면 ONTAP 백업 파일에서 볼륨, 폴더 또는 파일을 복구할 수 있습니다.  검색 및 복원을 사용하면 정확한 시스템, 볼륨 또는 파일 이름이 없어도 모든 백업(로컬 스냅샷, 복제된 볼륨, 개체 스토리지 포함)을 검색할 수 있습니다.

로컬 스냅샷이나 복제된 볼륨에서 복원하는 것이 일반적으로 개체 스토리지에서 복원하는 것보다 빠르고 비용이 저렴합니다.

전체 볼륨을 복원할 때 NetApp Backup and Recovery 백업 데이터를 사용하여 새 볼륨을 만듭니다.  원래 시스템, 동일한 클라우드 계정 내의 다른 시스템 또는 온프레미스 ONTAP 시스템으로 복원할 수 있습니다.  폴더와 파일은 원래 위치, 동일한 시스템의 다른 볼륨, 동일한 클라우드 계정의 다른 시스템 또는 온프레미스 시스템으로 복원할 수 있습니다.

복원 기능은 ONTAP 버전에 따라 다릅니다.

* *폴더:* ONTAP 9.13.0 이상을 사용하면 모든 파일과 하위 폴더가 포함된 폴더를 복원할 수 있습니다. 이전 버전에서는 폴더 내의 파일만 복원할 수 있습니다.
* *보관 저장소:* 보관 저장소( ONTAP 9.10.1 이상에서 사용 가능)에서 복원하는 경우 속도가 느리고 추가 비용이 발생할 수 있습니다.
* *목적지 클러스터 요구 사항:*
+
** 볼륨 복원: ONTAP 9.10.1 이상
** 파일 복원: ONTAP 9.11.1 이상
** Google Archive 및 StorageGRID: ONTAP 9.12.1 이상
** 폴더 복원: ONTAP 9.13.1 이상




ifdef::aws[]

link:prev-reference-aws-archive-storage-tiers.html["AWS 보관 스토리지에서 복원하는 방법에 대해 자세히 알아보세요."].

endif::aws[]

ifdef::azure[]

link:prev-reference-azure-archive-storage-tiers.html["Azure 보관 저장소에서 복원하는 방법에 대해 자세히 알아보세요."].

endif::azure[]

ifdef::gcp[]

link:prev-reference-gcp-archive-storage-tiers.html["Google 보관 저장소에서 복원하는 방법에 대해 자세히 알아보세요."].

endif::gcp[]

[NOTE]
====
* 개체 스토리지의 백업 파일에 DataLock 및 랜섬웨어 보호 기능이 구성된 경우, ONTAP 버전이 9.13.1 이상인 경우에만 폴더 수준 복원이 지원됩니다.  이전 버전의 ONTAP 사용하는 경우 백업 파일에서 전체 볼륨을 복원한 다음 필요한 폴더와 파일에 액세스할 수 있습니다.
* 개체 스토리지의 백업 파일이 보관 스토리지에 있는 경우, ONTAP 버전이 9.13.1 이상인 경우에만 폴더 수준 복원이 지원됩니다.  이전 버전의 ONTAP 사용하는 경우 보관되지 않은 최신 백업 파일에서 폴더를 복원하거나 보관된 백업에서 전체 볼륨을 복원한 다음 필요한 폴더와 파일에 액세스할 수 있습니다.
* Azure 보관 저장소에서 StorageGRID 시스템으로 데이터를 복원하는 경우 "높음" 복원 우선 순위는 지원되지 않습니다.
* 현재 ONTAP S3 개체 스토리지의 볼륨에서는 폴더 복원이 지원되지 않습니다.


====
시작하기 전에 복원하려는 볼륨이나 파일의 이름이나 위치를 어느 정도 알고 있어야 합니다.



== 검색 및 복원 지원 시스템 및 개체 스토리지 공급자

보조 시스템(복제된 볼륨) 또는 개체 스토리지(백업 파일)에 있는 백업 파일에서 ONTAP 데이터를 다음 시스템으로 복원할 수 있습니다. 스냅샷은 소스 시스템에 저장되며 동일한 시스템으로만 복원할 수 있습니다.

*참고:* 모든 유형의 백업 파일에서 볼륨과 파일을 복원할 수 있지만, 현재는 개체 스토리지의 백업 파일에서만 폴더를 복원할 수 있습니다.

[cols="33,33,33"]
|===
2+| 백업 파일 위치 | 목적지 시스템 


| *객체 저장소(백업)* | *2차 시스템(복제)* | ifdef::aws[] 


| 아마존 S3 | AWS 온프레미스 ONTAP 시스템의 Cloud Volumes ONTAP | AWS 온프레미스 ONTAP 시스템의 Cloud Volumes ONTAP endif::aws[] ifdef::azure[] 


| Azure Blob | Azure 온프레미스 ONTAP 시스템의 Cloud Volumes ONTAP | Azure 온프레미스 ONTAP 시스템의 Cloud Volumes ONTAP endif::azure[] ifdef::gcp[] 


| 구글 클라우드 스토리지 | Google 온프레미스 ONTAP 시스템의 Cloud Volumes ONTAP | Google 온프레미스 ONTAP 시스템의 Cloud Volumes ONTAP endif::gcp[] 


| NetApp StorageGRID | 온프레미스 ONTAP 시스템 Cloud Volumes ONTAP | 온프레미스 ONTAP 시스템 


| ONTAP S3 | 온프레미스 ONTAP 시스템 Cloud Volumes ONTAP | 온프레미스 ONTAP 시스템 
|===
검색 및 복원의 경우 콘솔 에이전트를 다음 위치에 설치할 수 있습니다.

ifdef::aws[]

* Amazon S3의 경우 콘솔 에이전트는 AWS 또는 사내에 배포될 수 있습니다.


endif::aws[]

ifdef::azure[]

* Azure Blob의 경우 콘솔 에이전트는 Azure 또는 사내에 배포될 수 있습니다.


endif::azure[]

ifdef::gcp[]

* Google Cloud Storage의 경우 콘솔 에이전트는 Google Cloud Platform VPC에 배포되어야 합니다.


endif::gcp[]

* StorageGRID 의 경우 콘솔 에이전트는 인터넷 접속 여부와 관계없이 사내에 배포되어야 합니다.
* ONTAP S3의 ​​경우 콘솔 에이전트는 인터넷 접속 여부와 관계없이 사내 또는 클라우드 공급자 환경에 배포될 수 있습니다.


"온프레미스 ONTAP 시스템"에 대한 참조에는 FAS, AFF 및 ONTAP Select 시스템이 포함됩니다.



== 검색 및 복원 필수 조건

* 클러스터 요구 사항:
+
** ONTAP 버전은 9.8 이상이어야 합니다.
** 볼륨이 있는 스토리지 VM(SVM)에는 구성된 데이터 LIF가 있어야 합니다.
** 볼륨에서 NFS를 활성화해야 합니다(NFS와 SMB/CIFS 볼륨 모두 지원됨).
** SVM에서 SnapDiff RPC 서버를 활성화해야 합니다. 시스템에서 인덱싱을 활성화하면 콘솔에서 자동으로 이 작업이 수행됩니다. (SnapDiff는 스냅샷 간의 파일 및 디렉토리 차이점을 빠르게 식별하는 기술입니다.)


* NetApp 검색 및 복원의 복원력을 높이기 위해 콘솔 에이전트에 별도의 볼륨을 마운트할 것을 권장합니다. 지침은 다음을 참조하세요.<<mount-volume-steps,카탈로그를 다시 인덱싱하려면 볼륨을 마운트하세요.>> .




=== 레거시 검색 및 복원 필수 구성 요소(인덱싱된 카탈로그 v1 사용)

ifdef::aws[]

* AWS 요구 사항:
+
** 콘솔에 권한을 제공하는 사용자 역할에 특정 Amazon Athena, AWS Glue 및 AWS S3 권한을 추가해야 합니다. link:prev-ontap-backup-onprem-aws.html["모든 권한이 올바르게 구성되었는지 확인하세요."].
+
과거에 구성한 콘솔 에이전트와 함께 NetApp Backup and Recovery 이미 사용하고 있는 경우 지금 콘솔 사용자 역할에 Athena 및 Glue 권한을 추가해야 합니다.  검색 및 복원에 필요합니다.





endif::aws[]

ifdef::azure[]

* Azure 요구 사항:
+
** 구독을 통해 Azure Synapse Analytics 리소스 공급자("Microsoft.Synapse")를 등록해야 합니다. https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/resource-providers-and-types#register-resource-provider["구독을 위해 이 리소스 공급자를 등록하는 방법을 확인하세요."^] .  리소스 공급자를 등록하려면 구독 *소유자* 또는 *기여자*여야 합니다.
** 콘솔에 권한을 제공하는 사용자 역할에 특정 Azure Synapse Workspace 및 Data Lake Storage 계정 권한을 추가해야 합니다. link:prev-ontap-backup-onprem-azure.html["모든 권한이 올바르게 구성되었는지 확인하세요."].
+
이전에 구성한 콘솔 에이전트와 함께 NetApp Backup and Recovery 이미 사용하고 있는 경우 지금 콘솔 사용자 역할에 Azure Synapse Workspace 및 Data Lake Storage 계정 권한을 추가해야 합니다.  검색 및 복원에 필요합니다.

** 콘솔 에이전트는 인터넷과의 HTTP 통신을 위해 프록시 서버 *없이* 구성되어야 합니다.  콘솔 에이전트에 대해 HTTP 프록시 서버를 구성한 경우 검색 및 복원 기능을 사용할 수 없습니다.




endif::azure[]

ifdef::gcp[]

* Google Cloud 요구 사항:
+
** NetApp Console 권한을 제공하는 사용자 역할에 특정 Google BigQuery 권한을 추가해야 합니다. link:prev-ontap-backup-onprem-gcp.html["모든 권한이 올바르게 구성되었는지 확인하세요."].
+
과거에 구성한 콘솔 에이전트와 함께 NetApp Backup and Recovery 이미 사용하고 있는 경우 지금 콘솔 사용자 역할에 BigQuery 권한을 추가해야 합니다.  검색 및 복원에 필요합니다.





endif::gcp[]

* StorageGRID 및 ONTAP S3 요구 사항:
+
구성에 따라 검색 및 복원이 구현되는 방법은 2가지가 있습니다.

+
** 계정에 클라우드 공급자 자격 증명이 없으면 인덱싱된 카탈로그 정보는 콘솔 에이전트에 저장됩니다.
+
Indexed Catalog v2에 대한 자세한 내용은 아래 섹션의 Indexed Catalog를 활성화하는 방법을 참조하세요.

** 개인(다크) 사이트에서 콘솔 에이전트를 사용하는 경우 인덱싱된 카탈로그 정보는 콘솔 에이전트에 저장됩니다(콘솔 에이전트 버전 3.9.25 이상 필요).
** 만약 당신이 가지고 있다면 https://docs.netapp.com/us-en/console-setup-admin/concept-accounts-aws.html["AWS 자격 증명"^] 또는 https://docs.netapp.com/us-en/console-setup-admin/concept-accounts-azure.html["Azure 자격 증명"^] 계정에서 색인된 카탈로그는 클라우드 제공자에 저장됩니다. 이는 클라우드에 배포된 콘솔 에이전트와 마찬가지입니다.  (두 자격 증명이 모두 있는 경우 기본적으로 AWS가 선택됩니다.)
+
온프레미스 콘솔 에이전트를 사용하는 경우에도 콘솔 에이전트 권한과 클라우드 공급자 리소스 모두에 대한 클라우드 공급자 요구 사항을 충족해야 합니다.  이 구현을 사용하는 경우 위의 AWS 및 Azure 요구 사항을 참조하세요.







== 검색 및 복원 프로세스

과정은 다음과 같습니다.

. 검색 및 복원을 사용하려면 먼저 볼륨 데이터를 복원하려는 각 소스 시스템에서 "인덱싱"을 활성화해야 합니다.  이를 통해 색인된 카탈로그는 모든 볼륨의 백업 파일을 추적할 수 있습니다.
. 볼륨 백업에서 볼륨이나 파일을 복원하려면 _검색 및 복원_에서 *검색 및 복원*을 선택합니다.
. 볼륨, 폴더 또는 파일에 대한 검색 기준을 부분 또는 전체 볼륨 이름, 부분 또는 전체 파일 이름, 백업 위치, 크기 범위, 생성 날짜 범위, 기타 검색 필터로 입력하고 *검색*을 선택합니다.
+
검색 결과 페이지에는 검색 기준과 일치하는 파일이나 볼륨이 있는 모든 위치가 표시됩니다.

. 볼륨이나 파일을 복원할 위치에 대해 *모든 백업 보기*를 선택한 다음, 사용하려는 실제 백업 파일에서 *복원*을 선택합니다.
. 볼륨, 폴더 또는 파일을 복원할 위치를 선택하고 *복원*을 선택합니다.
. 볼륨, 폴더 또는 파일이 복원됩니다.


image:diagram_search_restore_vol_file.png["검색 및 복원을 사용하여 볼륨, 폴더 또는 파일 복원 작업을 수행하는 흐름을 보여주는 다이어그램입니다."]

일부 이름만 알면 NetApp Backup and Recovery 검색 결과와 일치하는 모든 백업 파일을 검색합니다.



== 각 시스템에 대해 색인된 카탈로그를 활성화합니다.

검색 및 복원을 사용하려면 먼저 볼륨이나 파일을 복원할 각 소스 시스템에서 "인덱싱"을 활성화해야 합니다.  이를 통해 색인 카탈로그는 모든 볼륨과 모든 백업 파일을 추적하여 검색을 매우 빠르고 효율적으로 수행할 수 있습니다.

색인 카탈로그는 시스템의 모든 볼륨과 백업 파일에 대한 메타데이터를 저장하는 데이터베이스입니다.  이는 검색 및 복원 기능에서 복원하려는 데이터가 포함된 백업 파일을 빠르게 찾는 데 사용됩니다.

.색인된 카탈로그 기능
NetApp Backup and Recovery 인덱싱된 카탈로그를 사용할 때 별도의 버킷을 프로비저닝하지 않습니다. 대신 AWS, Azure, Google Cloud Platform, StorageGRID 또는 ONTAP S3에 저장된 백업의 경우 서비스는 콘솔 에이전트 또는 클라우드 공급자 환경에서 공간을 프로비저닝합니다.

색인 카탈로그는 다음을 지원합니다.

* 3분 이내에 글로벌 검색 효율성 향상
* 최대 50억 개의 파일
* 클러스터당 최대 5000개의 볼륨
* 볼륨당 최대 100K 스냅샷
* 기준 색인에 걸리는 최대 시간은 7일 미만입니다.  실제 시간은 환경에 따라 달라집니다.


.시스템에 대한 인덱싱을 활성화하는 단계:
시스템에서 인덱싱이 이미 활성화된 경우 다음 섹션으로 이동하여 데이터를 복원하세요.

먼저 카탈로그 파일을 보관할 별도의 볼륨을 마운트해야 합니다. 이렇게 하면 스냅샷을 보관하는 파일의 크기가 너무 커져도 데이터 손실을 방지할 수 있습니다. 이는 모든 클러스터에 필요한 것은 아닙니다. 사용자 환경의 모든 클러스터에서 원하는 볼륨을 마운트할 수 있습니다. 이렇게 하지 않으면 인덱싱이 제대로 작동하지 않을 수 있습니다.

장착된 볼륨의 경우 다음 크기 조정 지침을 사용하세요.

* NetApp NVS 볼륨 사용
* 300MB/s 디스크 처리량의 권장 AFF 스토리지입니다. 처리량이 낮아지면 검색 및 기타 작업에 영향을 미칩니다.
* 카탈로그 백업 zip 파일 외에도 카탈로그 메타데이터를 보호하기 위해 NetApp 스냅샷을 활성화합니다.
* 10억 개의 파일당 50GB
* 카탈로그 데이터를 위한 20GB, zip 파일 생성 및 임시 파일을 위한 추가 공간


[[mount-volume-steps]]
.카탈로그를 다시 인덱싱하기 위해 볼륨을 마운트하는 단계
. 볼륨을 마운트합니다 `/opt/application/netapp/cbs` 다음 명령을 입력하여 다음을 수행합니다.
+
** `volume name` 카탈로그 파일이 저장될 클러스터의 볼륨입니다.
** `/opt/application/netapp/cbs` 마운트되는 경로입니다
+
[source, console]
----
mount <cluster IP address>:/<volume name> /opt/application/netapp/cbs
----
+
예:

+
[source, console]
----
mount 10.192.24.17:/CATALOG_SCALE_234 /opt/application/netapp/cbs
----




.인덱스를 활성화하는 단계
. 다음 중 하나를 수행하세요.
+
** 시스템이 인덱싱되지 않은 경우, 복원 대시보드의 _검색 및 복원_에서 *시스템 인덱싱 사용*을 선택합니다.
** 하나 이상의 시스템이 이미 인덱싱된 경우, 복원 대시보드의 _검색 및 복원_에서 *인덱싱 설정*을 선택하세요.


. 시스템에 대해 *인덱싱 사용*을 선택합니다.


.결과
모든 서비스가 제공되고 색인 카탈로그가 활성화되면 시스템이 "활성"으로 표시됩니다.

시스템의 볼륨 크기와 3개 백업 위치의 백업 파일 수에 따라 초기 인덱싱 프로세스는 최대 1시간이 걸릴 수 있습니다.  그 후에는 점진적인 변경 사항을 매시간 투명하게 업데이트하여 최신 상태를 유지합니다.



== 검색 및 복원을 사용하여 볼륨, 폴더 및 파일 복원

당신이 가지고 후<<enable-the-indexed-catalog-for-each-system,시스템에 인덱싱이 활성화되었습니다.>> 검색 및 복원을 사용하여 볼륨, 폴더 및 파일을 복원할 수 있습니다. 이를 통해 광범위한 필터를 사용하여 모든 백업 파일에서 복원하려는 정확한 파일이나 볼륨을 찾을 수 있습니다.

.단계
. 콘솔 메뉴에서 *보호 > 백업 및 복구*를 선택합니다.
. *복원* 탭을 선택하면 복원 대시보드가 표시됩니다.
. _검색 및 복원_ 섹션에서 *검색 및 복원*을 선택합니다.
. _검색 및 복원_ 섹션에서 *검색 및 복원*을 선택합니다.
. 검색 및 복원 페이지에서:
+
.. _검색 창_에 볼륨 이름 전체 또는 일부, 폴더 이름 또는 파일 이름을 입력합니다.
.. 리소스 유형을 선택하세요: *볼륨*, *파일*, *폴더*, *모두*.
.. _필터 기준_ 영역에서 필터 기준을 선택합니다. 예를 들어, 데이터가 있는 시스템과 파일 형식(예: .JPEG 파일)을 선택할 수 있습니다. 또는 개체 스토리지에서 사용 가능한 스냅샷이나 백업 파일 내에서만 결과를 검색하려는 경우 백업 위치 유형을 선택할 수 있습니다.


. *검색*을 선택하면 검색 결과 영역에 검색 조건과 일치하는 파일, 폴더 또는 볼륨이 있는 모든 리소스가 표시됩니다.
. 복원하려는 데이터가 있는 리소스를 찾은 다음 *모든 백업 보기*를 선택하면 일치하는 볼륨, 폴더 또는 파일이 포함된 모든 백업 파일이 표시됩니다.
. 데이터를 복원하는 데 사용할 백업 파일을 찾아 *복원*을 선택합니다.
+
검색 결과에는 검색 대상 파일이 포함된 로컬 볼륨 스냅샷과 원격 복제 볼륨이 식별됩니다.  클라우드 백업 파일, 스냅샷 또는 복제된 볼륨에서 복원하도록 선택할 수 있습니다.

. 볼륨, 폴더 또는 파일을 복원할 대상 위치를 선택하고 *복원*을 선택합니다.
+
** 볼륨의 경우 원래 대상 시스템을 선택하거나 대체 시스템을 선택할 수 있습니다.  FlexGroup 볼륨을 복원할 때는 여러 개의 집계를 선택해야 합니다.
** 폴더의 경우 원래 위치로 복원할 수도 있고 시스템, 볼륨, 폴더 등의 대체 위치를 선택할 수도 있습니다.
** 파일의 경우 원래 위치로 복원할 수도 있고 시스템, 볼륨, 폴더 등의 대체 위치를 선택할 수도 있습니다.  원래 위치를 선택할 때, 소스 파일을 덮어쓸지 아니면 새 파일을 만들지 선택할 수 있습니다.
+
온프레미스 ONTAP 시스템을 선택하고 개체 스토리지에 대한 클러스터 연결을 아직 구성하지 않은 경우 추가 정보를 입력하라는 메시지가 표시됩니다.

+
ifdef::aws[]

+
*** Amazon S3에서 복원할 때 대상 볼륨이 상주할 ONTAP 클러스터의 IP 공간을 선택하고, ONTAP 클러스터에 S3 버킷에 대한 액세스 권한을 부여하기 위해 생성한 사용자의 액세스 키와 비밀 키를 입력하고, 선택적으로 안전한 데이터 전송을 위해 개인 VPC 엔드포인트를 선택합니다. link:prev-ontap-backup-onprem-aws.html["이러한 요구 사항에 대한 세부 정보를 확인하세요"].






endif::aws[]

ifdef::azure[]

* Azure Blob에서 복원할 때 대상 볼륨이 상주할 ONTAP 클러스터의 IP 공간을 선택하고, 필요에 따라 VNet 및 서브넷을 선택하여 안전한 데이터 전송을 위한 개인 엔드포인트를 선택합니다. link:prev-ontap-backup-onprem-azure.html["이러한 요구 사항에 대한 세부 정보를 확인하세요"].


endif::azure[]

ifdef::gcp[]

* Google Cloud Storage에서 복원할 때 대상 볼륨이 상주할 ONTAP 클러스터의 IP 공간을 선택하고, 개체 스토리지에 액세스하기 위한 액세스 키와 비밀 키를 선택합니다. link:prev-ontap-backup-onprem-gcp.html["이러한 요구 사항에 대한 세부 정보를 확인하세요"].


endif::gcp[]

* StorageGRID 에서 복원할 때 StorageGRID 서버의 FQDN과 ONTAP StorageGRID 와 HTTPS 통신에 사용해야 하는 포트를 입력하고, 개체 스토리지에 액세스하는 데 필요한 액세스 키와 비밀 키를 입력하고, 대상 볼륨이 있는 ONTAP 클러스터의 IP 공간을 입력합니다. link:prev-ontap-backup-onprem-storagegrid.html["이러한 요구 사항에 대한 세부 정보를 확인하세요"].
* ONTAP S3에서 복원할 때 ONTAP S3 서버의 FQDN과 ONTAP ONTAP S3와 HTTPS 통신에 사용해야 하는 포트를 입력하고, 개체 스토리지에 액세스하는 데 필요한 액세스 키와 비밀 키를 선택하고, 대상 볼륨이 상주할 ONTAP 클러스터의 IP 공간을 선택합니다. link:prev-ontap-backup-onprem-ontaps3.html["이러한 요구 사항에 대한 세부 정보를 확인하세요"].


.결과
볼륨, 폴더 또는 파일이 복원되고 복원 대시보드로 돌아와서 복원 작업의 진행 상황을 검토할 수 있습니다.  *작업 모니터링* 탭을 선택하여 복원 진행 상황을 확인할 수도 있습니다.  보다link:br-use-monitor-tasks.html["작업 모니터 페이지"] .
